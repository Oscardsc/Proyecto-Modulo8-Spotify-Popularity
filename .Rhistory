install.packages(“rsconnect”
install.packages(“rsconnect”)
install.packages(“rsconnect”)
install.packages(“rsconnect”)
install.packages("rsconnect")
library(rsconnect)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(janitor)
library(lubridate)
library(GGally)
library(dplyr)
library(tidyr)
spotify_raw <- readr::read_csv("dataset.csv")
glimpse(spotify_raw)
spotify <- spotify_raw %>%
clean_names()
spotify <- spotify %>%
select(-matches("^unnamed_0$|^x1$"), everything())
spotify <- spotify %>%
rename(
artist_name = artists,
genre       = track_genre
)
campos_clave <- c("track_id", "artist_name", "track_name", "popularity")
campos_clave_presentes <- intersect(names(spotify), campos_clave)
spotify <- spotify %>%
drop_na(all_of(campos_clave_presentes))
claves_dup <- intersect(names(spotify), c("track_id", "track_name"))
if (length(claves_dup) == 2) {
spotify <- spotify %>%
distinct(track_id, track_name, .keep_all = TRUE)
} else {
spotify <- spotify %>%
distinct(track_id, .keep_all = TRUE)
}
if ("duration_ms" %in% names(spotify)) {
spotify <- spotify %>%
mutate(duration_min = duration_ms / 60000)
}
spotify <- spotify %>%
mutate(popularity = as.numeric(popularity))
glimpse(spotify)
nrow(spotify)
length(names(spotify))
summary(spotify$popularity)
ggplot(spotify, aes(x = popularity)) +
geom_histogram(bins = 30, fill = "#1DB954", color = "white") +
theme_minimal() +
labs(
title = "Figura 1. Distribución de la popularidad de las canciones",
x = "Popularidad (0–100)",
y = "Frecuencia"
)
spotify_nonzero <- spotify %>%
filter(popularity > 0)
ggplot(spotify_nonzero, aes(x = popularity)) +
geom_histogram(bins = 30, fill = "#1DB954", color = "white") +
theme_minimal() +
labs(
title = "Figura 2. Distribución de popularidad excluyendo canciones con 0",
x = "Popularidad (1–100)",
y = "Frecuencia"
)
if ("duration_min" %in% names(spotify)) {
spotify %>%
filter(duration_min <= 8) %>%  # recorte para evitar colas extremas
ggplot(aes(x = duration_min)) +
geom_histogram(bins = 40, fill = "#C4B5FD", color = "white") +
theme_minimal() +
labs(
title = "Figura 3. Distribución de la duración de las canciones (0–8 min)",
x = "Duración (minutos)",
y = "Frecuencia"
)
}
library(stringr)
spotify_artistas <- spotify %>%
separate_rows(artist_name, sep = ";") %>%
mutate(artist_single = str_trim(artist_name))
artistas_stats <- spotify_artistas %>%
group_by(artist_single) %>%
summarise(
n_canciones = n_distinct(track_id),
popularidad_promedio = mean(popularity),
.groups = "drop"
)
top15_artistas <- artistas_stats %>%
filter(n_canciones >= 20) %>%        # filtro de estabilidad
arrange(desc(popularidad_promedio)) %>%
slice_head(n = 15)
top15_artistas
ggplot(top15_artistas %>% arrange(popularidad_promedio),
aes(x = popularidad_promedio,
y = reorder(artist_single, popularidad_promedio))) +
geom_col(fill = "#1DB954") +
geom_text(aes(label = round(popularidad_promedio, 1)),
hjust = -0.1, size = 3) +
xlim(0, 100) +
theme_minimal() +
labs(
title = "Figura 4. Top 15 artistas por popularidad promedio\n(mínimo 20 canciones)",
x = "Popularidad promedio",
y = "Artista"
)
vars_audio <- c("popularity", "danceability", "energy", "loudness",
"acousticness", "instrumentalness", "valence",
"tempo", "speechiness", "liveness", "duration_min")
vars_audio <- intersect(vars_audio, names(spotify))
mat_cor <- spotify %>%
select(all_of(vars_audio)) %>%
cor(use = "complete.obs")
round(mat_cor["popularity", ], 3)
spotify %>%
select(all_of(vars_audio)) %>%
ggpairs(
title = "Matriz de correlaciones entre popularidad y audio features",
progress = FALSE
)
rsconnect::setAccountInfo(name='soffochoa',
token='F955C4DA7B23B0E010A9EFA9B5887179',
secret='<SECRET>')
rsconnect::setAccountInfo(name='soffochoa',
token='F955C4DA7B23B0E010A9EFA9B5887179',
secret='<SECRET>')
rsconnect::setAccountInfo(name='soffochoa',
+                           token='F955C4DA7B23B0E010A9EFA9B5887179',
rsconnect::setAccountInfo(name='soffochoa', token='F955C4DA7B23B0E010A9EFA9B5887179', secret='d8NQpDhajXnJI0rHUc9Ez11VadCeias/yltAJWIH')
library(rsconnect)
deployApp()
deployApp()
library(rsconnect)
deployApp()
